"use strict";(self["webpackChunkguiness_front"]=self["webpackChunkguiness_front"]||[]).push([[926],{9926:function(t,e,s){s.r(e),s.d(e,{default:function(){return C}});var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-view"},[s("PostItem")],1)},n=[],i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"post-card__wrapper"},[s("div",{staticClass:"post-card"},[s("div",{staticClass:"post-card__img"},[s("img",{staticStyle:{width:"100%"},attrs:{src:t.img,alt:""}})]),s("div",[s("div",{staticClass:"post-card__follow"},[s("div",[s("span",[t._v("작성자 ID: "+t._s(t.postData.writerID))]),this.$store.state.userID!=this.postData.writerID?s("button",{staticClass:"btn-like",attrs:{type:"button"},on:{click:t.followUser}},[t._v(" 팔로우 "),s("i",{class:["fa-heart",t.follow?"fas":"far"]})]):t._e(),this.$store.state.userID==this.postData.writerID?s("div",[s("span",{staticClass:"myPost"},[t._v(" [내가 쓴 글] ")])]):t._e()]),this.$store.state.userID==this.postData.writerID?s("div",{staticClass:"post-card__btns"},[s("button",{staticClass:"btn__edit",on:{click:t.editPost}},[t._v("수정")]),s("button",{staticClass:"btn__delete",on:{click:t.deletePost}},[t._v("삭제")])]):t._e()]),s("div",{staticClass:"post-card__contents"},[s("h3",{staticClass:"text__title"},[t._v(t._s(t.postData.postTitle))]),s("div",{staticClass:"text__contents"},[t._v(t._s(t.postData.content))]),t._l(t.comments,(function(e,o){return s("div",{key:e.index,staticClass:"text__comments"},[s("span",[t._v(" "+t._s(e.content))]),s("div",[s("span",[t._v("ID: "+t._s(e.userID))]),s("button",{staticClass:"btn_del-comment",on:{click:function(e){return t.deleteComment(o)}}},[t._v(" 삭제 ")])])])})),s("button",{staticClass:"btn-like",attrs:{type:"button",disabled:!this.likeAble},on:{click:t.likePost}},[t._v(" 좋아요 "+t._s(this.postData.likeNum)+"  "),s("i",{class:["fa-heart",0==this.likeAble?"fas":"far"]})]),s("button",{staticClass:"btn-report",attrs:{type:"button",disabled:!this.reportAble},on:{click:t.reportPost}},[t._v(" 신고하기 "+t._s(t.postData.reportCount)+"  ")])],2),s("div",{staticClass:"comment-form"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}}),s("button",{attrs:{disabled:!this.comment},on:{click:t.createComment}},[t._v(" 작성 ")])])])])])])},a=[],c=s(9344),r=s(866);function l(t){return r.eE.post("comm/comment",t)}function u(t){return r.eE.get(`comm/comments/${t}`)}function h(t){return r.eE["delete"](`comm/comment/${t}`)}var f=s(8383),m=s(4900);function p(t,e){return r.eE.get(`/report/check/${t}/${e}`)}function d(t,e){return r.eE.post(`/report/report/${t}/${e}`)}var w=s(6166),_=s.n(w),g={async created(){await this.fetchPost(),await this.getImg(),await this.fetchComments(),await this.fetchFollowee(),await this.checkFollow(),await this.fetchIfUserLiked(),await this.fetchReport()},mounted(){console.log("id:",this.$route.params.id)},data(){return{title:"제목",contents:"내용",comments:[],comment:"",commentNum:"",postData:[{likeNum:0,reportCount:0}],postId:this.$route.params.id,follow:!1,username:"닉네임",writerID:"",followeeList:[],likeValue:0,reportValue:0,likeAble:!1,reportAble:!1,img:""}},computed:{},methods:{async checkFollow(){try{const t=await this.writerID,e=this.followeeList.some((function(e){return e.followeeID==t}));this.follow=e,console.log("내가 이미 글쓴이를 팔로우 중인지",e)}catch(t){console.log(t)}},async fetchPost(){try{const{data:t}=await(0,c.SD)(this.postId);console.log(t),this.postData=t,this.writerID=t.writerID}catch(t){console.log(t)}},async fetchIfUserLiked(){try{const{data:t}=await(0,m.hw)(this.postId,this.$store.state.userID);console.log("좋아요 여부",t[0]["count(*)"]),0==t[0]["count(*)"]?this.likeAble=!0:this.likeAble=!1}catch(t){console.log(t)}},async likePost(){this.postData.likeNum+=1;try{if(1!=this.likeAble)return this.postId;{const{data:t}=await(0,m.j)(this.postId,this.$store.state.userID);this.likeAble=!1,console.log("좋아요 누름",t)}}catch(t){console.log(t)}finally{this.fetchPost()}},async fetchReport(){try{const{data:t}=await p(this.postId,this.$store.state.userID);0==t[0]["count(*)"]?this.reportAble=!0:this.reportAble=!1,console.log("신고 값 반환",this.reportAble)}catch(t){console.log(t)}},async reportPost(){this.postData.reportCount+=1;try{if(0!=this.reportValue)return this.postId;{const{data:t}=await d(this.postId,this.$store.state.userID);console.log("신고 누름",t),this.reportAble=!1}}catch(t){console.log(t)}finally{this.fetchReport()}},async fetchFollowee(){try{const{data:t}=await(0,f.kQ)(this.$store.state.userID);this.followeeList=t,console.log("나의 팔로위 목록 배열로 조회",this.followeeList)}catch(t){console.log(t)}},async followUser(){try{const t=this.postData.writerID,e=this.$store.state.userID;if(0==this.follow){const{data:s}=await(0,f.PX)(e,t);this.follow=!0,console.log("팔로우",s),alert("작성자를 팔로우하였습니다.")}else await(0,f.VR)(e,t),this.follow=!1,console.log("팔로우 취소"),alert("작성자를 언팔로우하였습니다.")}catch(t){console.log(t)}},async deletePost(){const t=confirm("정말 삭제하시겠습니까?");if(1==t)try{const{data:t}=await(0,c.fR)(this.postId);console.log(t),this.$router.push("category")}catch(e){console.log(e)}else console.log("삭제 취소")},async editPost(){const t=this.postId;this.$router.push({path:`/postview/edit/${t}`,replace:!0})},async createComment(){try{const{data:t}=await l({content:this.comment,userID:this.$store.state.userID,postNum:this.postId});console.log(t)}catch(t){console.log(t)}finally{this.initForm(),this.fetchComments()}},async fetchComments(){const{data:t}=await u(this.postId);this.comments=t,console.log(t),console.log("댓글",this.comments)},initForm(){this.comment=""},async deleteComment(t){if(this.comments[t].userID!=this.$store.state.userID)return alert("본인이 작성한 댓글만 삭제할 수 있습니다");{const s=confirm("정말 삭제하시겠습니까?");if(1==s)try{const{data:e}=await h(this.comments[t].commentNum);console.log(e),this.fetchComments()}catch(e){console.log(e)}else console.log("삭제 취소")}},async getImg(){const t=parseInt(this.postId);_().get(`${{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_API_URL}post/image/${t}`).then((t=>{const e=t.data[0].file_src;this.img=e,console.log("이미지 조회",t.data[0].file_src)}))}}},I=g,v=s(1001),D=(0,v.Z)(I,i,a,!1,null,"2d059628",null),$=D.exports,k={components:{PostItem:$}},y=k,b=(0,v.Z)(y,o,n,!1,null,null,null),C=b.exports},8383:function(t,e,s){s.d(e,{$e:function(){return a},PX:function(){return n},VR:function(){return i},kQ:function(){return c}});var o=s(866);function n(t,e){return o.eE.post(`foll/create/${t}/${e}`)}function i(t,e){return o.eE["delete"](`foll/delete/${t}/${e}`)}function a(t){return o.eE.get(`foll/followers/${t}`)}function c(t){return o.eE.get(`foll/followees/${t}`)}},4900:function(t,e,s){s.d(e,{hw:function(){return i},j:function(){return a},zn:function(){return n}});var o=s(866);function n(t){return o.eE.get(`like/likedPosts/${t}`)}function i(t,e){return o.eE.get(`like/liked/${t}/${e}`)}function a(t,e){return o.eE.post(`like/like/${t}/${e}`)}},9344:function(t,e,s){s.d(e,{Bn:function(){return r},SD:function(){return n},dq:function(){return c},fR:function(){return a},qb:function(){return i}});var o=s(866);function n(t){return o.eE.get(`post/posts/${t}`)}function i(t){return o.eE.post("post/posts",t)}function a(t){return o.eE["delete"](`post/posts/${t}`)}function c(t,e){return o.eE.put(`post/posts/${t}`,e)}function r(t){return o.eE.get(`/post/postsByCat/${t}`)}}}]);
//# sourceMappingURL=926.c3306197.js.map