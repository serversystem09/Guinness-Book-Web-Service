"use strict";(self["webpackChunkguiness_front"]=self["webpackChunkguiness_front"]||[]).push([[490],{3490:function(t,o,s){s.r(o),s.d(o,{default:function(){return y}});var e=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",{staticClass:"post-view"},[s("PostItem")],1)},n=[],i=function(){var t=this,o=t.$createElement,s=t._self._c||o;return s("div",[s("div",{staticClass:"post-card__wrapper"},[s("div",{staticClass:"post-card"},[s("div",{staticClass:"post-card__img"},[t._v("이미지 자리")]),s("div",[s("div",{staticClass:"post-card__follow"},[s("div",[s("span",[t._v(t._s(t.postData.writerID))]),this.$store.state.userID!=this.postData.writerID?s("button",{staticClass:"btn-like",attrs:{type:"button"},on:{click:t.followUser}},[t._v(" 팔로우 "),s("i",{class:["fa-heart",t.follow?"fas":"far"]})]):t._e(),this.$store.state.userID==this.postData.writerID?s("div",[s("span",{staticClass:"myPost"},[t._v(" [내가 쓴 글] ")])]):t._e()]),this.$store.state.userID==this.postData.writerID?s("div",{staticClass:"post-card__btns"},[s("button",{staticClass:"btn__edit",on:{click:t.editPost}},[t._v("수정")]),s("button",{staticClass:"btn__delete",on:{click:t.deletePost}},[t._v("삭제")])]):t._e()]),s("div",{staticClass:"post-card__contents"},[s("h3",{staticClass:"text__title"},[t._v(t._s(t.postData.postTitle))]),s("div",{staticClass:"text__contents"},[t._v(t._s(t.postData.content))]),t._l(t.comments,(function(o,e){return s("div",{key:o.index,staticClass:"text__comments"},[s("span",[t._v(" "+t._s(o.content))]),s("span",[t._v(" "+t._s(o.userID))]),s("button",{staticClass:"btn_del-comment",on:{click:function(o){return t.deleteComment(e)}}},[t._v(" 삭제 ")])])})),s("button",{staticClass:"btn-like",attrs:{type:"button"},on:{click:t.likePost}},[t._v(" 좋아요 "+t._s(t.postData.likeNum)+"  ")]),s("button",{staticClass:"btn-report",attrs:{type:"button"},on:{click:t.reportPost}},[t._v(" 신고하기 "+t._s(t.postData.reportCount)+"  ")])],2),s("div",{staticClass:"comment-form"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],domProps:{value:t.comment},on:{input:function(o){o.target.composing||(t.comment=o.target.value)}}}),s("button",{attrs:{disabled:!this.comment},on:{click:t.createComment}},[t._v(" 작성 ")])])])])])])},c=[],a=s(9344),r=s(866);function l(t){return r.eE.post("comm/comment",t)}function u(t){return r.eE.get(`comm/comments/${t}`)}function m(t){return r.eE["delete"](`comm/comment/${t}`)}var f=s(8383),h={async created(){await this.fetchPost(),await this.fetchComments(),await this.fetchFollowee(),await this.checkFollow()},mounted(){console.log("id:",this.$route.params.id)},data(){return{title:"제목",contents:"내용",comments:[],comment:"",commentNum:"",postData:[],postId:this.$route.params.id,liked:!1,follow:!1,username:"닉네임",writerID:"",followeeList:[]}},methods:{async checkFollow(){try{const t=await this.writerID,o=this.followeeList.some((function(o){return o.followeeID==t}));this.follow=o,console.log("내가 이미 글쓴이를 팔로우 중인지",o)}catch(t){console.log(t)}},async fetchPost(){try{const{data:t}=await(0,a.SD)(this.postId);console.log("게시글 데이터",t),this.postData=t,this.writerID=t.writerID}catch(t){console.log(t)}},async likePost(){try{if(0!=this.liked)return this.postId;{this.liked=!this.liked;const{data:t}=await(0,a.n9)(this.postId);console.log("좋아요",t),this.postData.likeNum-=1}}catch(t){console.log(t)}finally{this.fetchPost()}},async reportPost(){try{const{data:t}=await(0,a.mK)(this.postId);console.log("게시글 신고",t),this.$router.go(this.$router.currentRoute)}catch(t){console.log(t)}finally{this.fetchPost()}},async fetchFollowee(){try{const{data:t}=await(0,f.kQ)(this.$store.state.userID);this.followeeList=t,console.log("나의 팔로위 목록 배열로 조회",this.followeeList)}catch(t){console.log(t)}},async followUser(){try{const t=this.postData.writerID,o=this.$store.state.userID;if(0==this.follow){const{data:s}=await(0,f.PX)(o,t);this.follow=!0,console.log("팔로우",s)}else await(0,f.VR)(o,t),this.follow=!1,console.log("팔로우 취소")}catch(t){console.log(t)}},async deletePost(){const t=confirm("정말 삭제하시겠습니까?");if(1==t){try{const{data:t}=await(0,a.fR)(this.postId);console.log(t)}catch(o){console.log(o)}this.$router.push("/category")}else console.log("삭제 취소")},async editPost(){const t=this.postId;this.$router.push({path:`/edit/${t}`,replace:!0})},async createComment(){try{const{data:t}=await l({content:this.comment,userID:this.$store.state.userID,postNum:this.postId});console.log(t)}catch(t){console.log(t)}finally{this.initForm(),this.fetchComments()}},async fetchComments(){const{data:t}=await u(this.postId);this.comments=t,console.log(t),console.log("댓글",this.comments)},initForm(){this.comment=""},async deleteComment(t){const o=confirm("정말 삭제하시겠습니까?");if(1==o)try{const{data:o}=await m(this.comments[t].commentNum);console.log(o),this.fetchComments()}catch(s){console.log(s)}else console.log("삭제 취소")}}},p=h,d=s(3736),_=(0,d.Z)(p,i,c,!1,null,"3d667940",null),w=_.exports,v={components:{PostItem:w}},g=v,D=(0,d.Z)(g,e,n,!1,null,null,null),y=D.exports},8383:function(t,o,s){s.d(o,{$e:function(){return c},PX:function(){return n},VR:function(){return i},kQ:function(){return a}});var e=s(866);function n(t,o){return e.eE.post(`foll/create/${t}/${o}`)}function i(t,o){return e.eE["delete"](`foll/delete/${t}/${o}`)}function c(t){return e.eE.get(`foll/followers/${t}`)}function a(t){return e.eE.get(`foll/followees/${t}`)}},9344:function(t,o,s){s.d(o,{Bn:function(){return l},SD:function(){return n},Ti:function(){return r},dq:function(){return a},fR:function(){return c},mK:function(){return m},n9:function(){return u},qb:function(){return i}});var e=s(866);function n(t){return e.eE.get(`post/posts/${t}`)}function i(t){return e.eE.post("post/posts",t)}function c(t){return e.eE["delete"](`post/posts/${t}`)}function a(t,o){return e.eE.put(`post/posts/${t}`,o)}function r(){return e.eE.post("/post/uploadphoto")}function l(t){return e.eE.get(`/post/postsByCat/${t}`)}function u(t){return e.eE.put(`/post/like/${t}`)}function m(t){return e.eE.put(`/post/report/${t}`)}}}]);
//# sourceMappingURL=490.96340022.js.map